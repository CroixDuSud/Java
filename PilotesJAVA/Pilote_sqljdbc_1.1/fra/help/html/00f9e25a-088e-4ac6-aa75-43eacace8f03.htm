<html DIR="LTR" xmlns:tool="http://www.microsoft.com/tooltip" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1252" />
    <META NAME="save" CONTENT="history" />
    <title>Utilisation de séquences d'échappement SQL</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/script_loc.js">
      
    </script>
    <script src="../local/script_main.js">
      
    </script>
  </head>
  <body style="display: none;">
    <!--Topic built:11/3/2006-->
<input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <div id="header">
        <tr>
          <td align="left">
            <span id="headerBold">Utilisation de séquences d'échappement SQL</span>
          </td>
        </tr>
      </table>
      <IMG id="SeeAlso1" style="display:none; height:0; width:0;" src="../local/SeeAlso1a.gif">
        
      </IMG>
      <IMG id="SeeAlso2" style="display:none; height:0; width:0;" src="../local/SeeAlso1c.gif">
        
      </IMG>
      <IMG id="Filter1" style="display:none; height:0; width:0;" src="../local/Filter1a.gif">
        
      </IMG>
      <IMG id="Filter2" style="display:none; height:0; width:0;" src="../local/Filter1c.gif">
        
      </IMG>
      <span style="display:none" id="languageSpan">
        <h1 class="heading">
          Langage
        </h1>
        <div id="selectLanguage" class="section">
          <div class="languageFilter" id="VisualBasic" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [Visual Basic]
          </div>
          <div class="languageFilter" id="CSharp" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [C#]
          </div>
          <div class="languageFilter" id="ManagedCPlusPlus" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [C++]
          </div>
          <div class="languageFilter" id="JSharp" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [J#]
          </div>
          <div class="languageFilter" id="JScript" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [JScript]
          </div>
          <div class="languageFilter" id="all" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            (Afficher tout)
          </div>
        </div>
      </span>
    </div>
    <div id="mainSection">
      <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
      </div>
      <font color="DarkGray"><!-- [This topic is pre-release documentation and is subject to change in future releases. Blank topics are included as placeholders.]<br/>[Documentation built on 11/3/2006]  --></font><p /><p />
      <div id="introductionSection" class="section">
    <p>Le pilote JDBC de Microsoft SQL Server 2005 prend en charge l'utilisation des séquences d'échappement SQL telle que définies par l'API JDBC. Des séquences d'échappement sont utilisées dans des instructions SQL pour indiquer au pilote que la partie d'échappement de la chaîne SQL doit être traitée différemment. Lorsque le pilote JDBC traite la partie d'échappement d'une chaîne SQL, il la convertit en code SQL compréhensible pour SQL Server.</p>
    <p>L'API JDBC requiert cinq types de séquences d'échappement, qui sont tous pris en charge par le pilote JDBC :</p>
    <ul><li>
        Littéraux de caractère générique LIKE<br></br>
      </li><li>
        Gestion de fonction<br></br>
      </li><li>
        Littéraux de date et d'heure<br></br>
      </li><li>
        Appels de procédures stockées<br></br>
      </li><li>
        Jointures externes<br></br>
      </li></ul>
    <p>La syntaxe de la séquence d'échappement utilisée par le pilote JDBC est la suivante : </p>
    <p><code>{keyword ...parameters...}</code></p>
    <div style="margin: .5em 1.5em .5em 1.5em"><b>Remarque : </b>
      Le traitement d'échappement SQL est toujours activé pour le pilote JDBC.<p></p>
    </div>
    <p>Les sections suivantes décrivent les cinq types de séquences d'échappement et la manière dont celles-ci sont prises en charge par le pilote JDBC.</p>
  </div>
      <h1 class="heading">Littéraux de caractère générique LIKE</h1>
      <div id="sectionSection" class="section">
        <content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <p xmlns="">Le pilote JDBC prend en charge la syntaxe <code>{escape 'escape character'}</code> pour l'utilisation de caractères génériques de clause LIKE comme littéraux. Par exemple, le code suivant retourne des valeurs pour col3, où la valeur de col2 commence littéralement par un trait de soulignement (et non par sa valeur de caractère générique).</p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div>
      <div style="margin: .5em 1.5em .5em 1.5em" xmlns=""><b>Remarque : </b>
        La séquence d'échappement doit se trouver à la fin de l'instruction SQL. Si une seule chaîne de commande contient plusieurs instructions SQL, la séquence d'échappement doit figurer à la fin de chaque instruction SQL concernée.<p></p>
      </div>
    </content>
      </div>
      <h1 class="heading">Gestion de fonction</h1>
      <div id="sectionSection" class="section">
        <content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <p xmlns="">Le pilote JDBC prend en charge les séquences d'échappement de fonction dans les instructions SQL à l'aide de la syntaxe suivante :</p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>{fn functionName}</pre></span></div>
      <p xmlns="">où <code>functionName</code> est une fonction prise en charge par le pilote JDBC. Par exemple :</p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>SELECT {fn UPPER(Name)} FROM Employee</pre></span></div>
      <p xmlns="">Le tableau suivant répertorie les différentes fonctions prises en charge par le pilote JDBC en cas d'utilisation d'une séquence d'échappement de fonction :</p>
      <h2 class="heading" xmlns=""></h2><table cellspacing="0" cellpadding="0" border="1" style="background-color: #CCCCCC;" xmlns=""><tr>
            <th>
              Fonctions de chaîne
            </th>
            <th>
              Fonctions numériques
            </th>
            <th>
              Fonctions de date/d'heure
            </th>
            <th>
              Fonctions système
            </th>
          </tr><tr>
          <td>
            <p>ASCII</p>
            <p>CHAR</p>
            <p>CONCAT</p>
            <p>DIFFERENCE</p>
            <p>INSERT</p>
            <p>LCASE</p>
            <p>LEFT</p>
            <p>LENGTH</p>
            <p>LOCATE</p>
            <p>LTRIM</p>
            <p>REPEAT</p>
            <p>REPLACE</p>
            <p>RIGHT</p>
            <p>RTRIM</p>
            <p>SOUNDEX</p>
            <p>SPACE</p>
            <p>SUBSTRING</p>
            <p>UCASE</p>
          </td>
          <td>
            <p>ABS</p>
            <p>ACOS</p>
            <p>ASIN</p>
            <p>ATAN</p>
            <p>ATAN2</p>
            <p>CEILING</p>
            <p>COS</p>
            <p>COT</p>
            <p>DEGREES</p>
            <p>EXP</p>
            <p>FLOOR</p>
            <p>LOG</p>
            <p>LOG10</p>
            <p>MOD</p>
            <p>PI</p>
            <p>POWER</p>
            <p>RADIANS</p>
            <p>RAND</p>
            <p>ROUND</p>
            <p>SIGN</p>
            <p>SIN</p>
            <p>SQRT</p>
            <p>TAN</p>
            <p>TRUNCATE</p>
          </td>
          <td>
            <p>CURDATE</p>
            <p>CURTIME</p>
            <p>DAYNAME</p>
            <p>DAYOFMONTH</p>
            <p>DAYOFWEEK</p>
            <p>DAYOFYEAR</p>
            <p>EXTRACT</p>
            <p>HOUR</p>
            <p>MINUTE</p>
            <p>MONTH</p>
            <p>MONTHNAME</p>
            <p>NOW</p>
            <p>QUARTER</p>
            <p>SECOND</p>
            <p>TIMESTAMPADD</p>
            <p>TIMESTAMPDIFF</p>
            <p>WEEK</p>
            <p>YEAR</p>
          </td>
          <td>
            <p>DBNAME</p>
            <p>IFNULL</p>
            <p>USER</p>
          </td>
        </tr></table>
      <div style="margin: .5em 1.5em .5em 1.5em" xmlns=""><b>Remarque : </b>
        Toute tentative d'utiliser une fonction non prise en charge par la base de données génère une erreur.<p></p>
      </div>
    </content>
      </div>
      <h1 class="heading">Littéraux de date et d'heure</h1>
      <div id="sectionSection" class="section">
        <content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <p xmlns="">La syntaxe d'échappement pour les littéraux de date, d'heure et d'horodatage est la suivante : </p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div>
      <p xmlns="">où <code>literal-type</code> est l'un des éléments suivants :</p>
      <h2 class="heading" xmlns=""></h2><table cellspacing="0" cellpadding="0" border="1" style="background-color: #CCCCCC;" xmlns=""><tr>
            <th>
              Type de littéral
            </th>
            <th>
              Description
            </th>
            <th>
              Format de la valeur
            </th>
          </tr><tr>
          <td>
            <p>d</p>
          </td>
          <td>
            <p>Date</p>
          </td>
          <td>
            <p>aaaa-mm-jj</p>
          </td>
        </tr><tr>
          <td>
            <p>t</p>
          </td>
          <td>
            <p>Heure</p>
          </td>
          <td>
            <p>hh:mm:ss [1]</p>
          </td>
        </tr><tr>
          <td>
            <p>ts</p>
          </td>
          <td>
            <p>Horodatage</p>
          </td>
          <td>
            <p>aaaa-mm-jj hh:mm:ss[.f...]</p>
          </td>
        </tr></table>
      <p xmlns="">Par exemple :</p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div>
    </content>
      </div>
      <h1 class="heading">Appels de procédures stockées</h1>
      <div id="sectionSection" class="section">
        <content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <p xmlns="">Le pilote JDBC prend en charge les syntaxes d'échappement <code>{? = call proc_name(?,...)}</code> et <code>{call proc_name(?,...)}</code> pour les appels de procédures stockées, en fonction de la nécessité pour vous de traiter un paramètre retourné. </p>
      <p xmlns="">Une procédure est un objet exécutable stocké dans la base de données. Généralement, il s'agit d'une ou plusieurs instructions SQL recompilées. La syntaxe de la séquence d'échappement pour l'appel d'une procédure stockée est la suivante : </p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div>
      <p xmlns="">où <code>procedure-name</code> spécifie le nom d'une procédure stockée et <code>parameter</code> spécifie un paramètre de procédure stockée.</p>
      <p xmlns="">Pour plus d'informations sur l'utilisation de la séquence d'échappement <code>call</code> avec des procédures stockées, consultez <a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Utilisation d'instructions avec des procédures stockées</a>.</p>
    </content>
      </div>
      <h1 class="heading">Jointures externes</h1>
      <div id="sectionSection" class="section">
        <content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <p xmlns="">Le pilote JDBC prend en charge la syntaxe de jointure externe gauche, droite et complète de SQL92. La séquence d'échappement pour les jointures externes est la suivante : </p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div>
      <p xmlns="">où outer-join est :</p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div>
      <p xmlns="">où <code>table-reference</code> est un nom de table et <code>search-condition</code> est la condition de jointure que vous souhaitez utiliser pour les tables.</p>
      <p xmlns="">Par exemple :</p>
      <div class="sampleCode" xmlns=""><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div>
      <p xmlns="">Le pilote JDBC prend en charge les séquences d'échappement de jointure externe suivantes :</p>
      <ul xmlns=""><li>
          Jointures externes gauches<br></br>
        </li><li>
          Jointures externes droites<br></br>
        </li><li>
          Jointures externes complètes<br></br>
        </li><li>
          Jointures externes imbriquées<br></br>
        </li></ul>
    </content>
      </div>
      <span id="seeAlsoSpan">
        <h1 class="heading">
          Voir aussi
        </h1>
        <div id="seeAlsoSection" class="section">
          <a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Utilisation d'instructions avec le pilote JDBC</a>
        </div>
      </span>
      <!--[if gte IE 5]>
			<tool:tip element="seeAlsoToolTip" avoidmouse="false"/><tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]-->
      <div id="footer" class="section">
        <hr /><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span>
		<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">
			
			© 2006 Microsoft Corporation. Tous droits réservés.
		</a>
 	
      </div>
    </div>
  </body>
</html>