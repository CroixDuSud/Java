<html DIR="LTR" xmlns:tool="http://www.microsoft.com/tooltip" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1252" />
    <META NAME="save" CONTENT="history" />
    <title>Utilisation de plusieurs jeux de résultats</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/script_loc.js">
      
    </script>
    <script src="../local/script_main.js">
      
    </script>
  </head>
  <body style="display: none;">
    <!--Topic built:11/3/2006-->
<input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <div id="header">
        <tr>
          <td align="left">
            <span id="headerBold">Utilisation de plusieurs jeux de résultats</span>
          </td>
        </tr>
      </table>
      <IMG id="SeeAlso1" style="display:none; height:0; width:0;" src="../local/SeeAlso1a.gif">
        
      </IMG>
      <IMG id="SeeAlso2" style="display:none; height:0; width:0;" src="../local/SeeAlso1c.gif">
        
      </IMG>
      <IMG id="Filter1" style="display:none; height:0; width:0;" src="../local/Filter1a.gif">
        
      </IMG>
      <IMG id="Filter2" style="display:none; height:0; width:0;" src="../local/Filter1c.gif">
        
      </IMG>
      <span style="display:none" id="languageSpan">
        <h1 class="heading">
          Langage
        </h1>
        <div id="selectLanguage" class="section">
          <div class="languageFilter" id="VisualBasic" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [Visual Basic]
          </div>
          <div class="languageFilter" id="CSharp" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [C#]
          </div>
          <div class="languageFilter" id="ManagedCPlusPlus" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [C++]
          </div>
          <div class="languageFilter" id="JSharp" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [J#]
          </div>
          <div class="languageFilter" id="JScript" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            [JScript]
          </div>
          <div class="languageFilter" id="all" onclick="ChangeLanguage(this.id)" onkeypress="ChangeLanguage_CheckKey(this.id)" tabindex="0">
            (Afficher tout)
          </div>
        </div>
      </span>
    </div>
    <div id="mainSection">
      <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
      </div>
      <font color="DarkGray"><!-- [This topic is pre-release documentation and is subject to change in future releases. Blank topics are included as placeholders.]<br/>[Documentation built on 11/3/2006]  --></font><p /><p />
      <div id="introductionSection" class="section">
    <p>Lorsque l'on travaille sur des procédures stockées SQL Server ou SQL incluses qui retournent plus d'un jeu de résultats, le pilote JDBC de Microsoft de SQL Server 2005 propose la méthode <a href="929a14e2-8e98-4c32-89aa-86733c717ec1.htm">getResultSet</a> de la classe <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a> pour l'extraction de chaque jeu de données retourné. En outre, lors de l'exécution d'une instruction qui retourne plus d'un jeu de résultats, vous pouvez utiliser la méthode <b>execute</b> de la classe <b>SQLServerStatement</b> car elle retourne une valeur booléenne qui indique si la valeur retournée est un jeu de résultats ou un nombre de mises à jour.</p>
    <p>Si la méthode <b>execute</b> retourne la valeur « true », l'instruction exécutée a retourné au moins un jeu de résultats. Vous pouvez accéder au premier jeu de résultats en appelant la méthode <b>getResultSet</b>. Pour déterminer si des jeux de résultats supplémentaires sont disponibles, vous pouvez appeler la méthode <a href="6b18510a-4d6d-4eeb-a9d0-32e920eb0048.htm">getMoreResults</a>, qui retourne une valeur booléenne « true » en cas de disponibilité de jeux de résultats supplémentaires. Si des jeux de résultats supplémentaires sont disponibles, vous pouvez appeler la méthode <b>getResultSet</b> pour y accéder, tout en continuant le processus jusqu'à ce que tous les jeux de résultats soient traités. Si la méthode <b>getMoreResults</b> retourne la valeur « false », cela signifie qu'il n'y a plus de jeu de résultats à traiter.</p>
    <p>Si la méthode <b>execute</b> retourne la valeur « false », cela signifie que l'instruction exécutée a retourné un nombre de mises à jour, que vous pouvez extraire en appelant la méthode <a href="e9570228-4500-44b6-b2f1-84ac050b5112.htm">getUpdateCount</a>.</p>
    <div style="margin: .5em 1.5em .5em 1.5em"><b>Remarque : </b>
      Pour plus d'informations sur le nombre de mises à jour, voir <a href="64cf4877-5995-4bfc-8865-b7618a5c8d01.htm">Utilisation d'une procédure stockée avec un nombre de mises à jour</a>.<p></p>
    </div>
    <p>Dans l'exemple suivant, une connexion ouverte à l'exemple de base de données SQL Server AdventureWorks est transmise à la fonction et une instruction SQL est créée, qui retourne deux jeux de résultats lors de son exécution :</p>
    <div class="sampleCode">
		<span class="langLabel" name="label"></span><span codeLanguage="other"><pre>public static void executeStatement(Connection con) {
   try {
      String SQL = "SELECT TOP 10 * FROM Person.Contact; _" +
                   "SELECT TOP 20 * FROM Person.Contact";
      Statement stmt = con.createStatement();
      boolean results = stmt.execute(SQL);
      int rsCount = 0;

      //Loop through the available result sets.
     do {
        if(results) {
           ResultSet rs = stmt.getResultSet();
           rsCount++;

           //Show data from the result set.
           System.out.println("RESULT SET #" + rsCount);
           while (rs.next()) {
              System.out.println(rs.getString("LastName") + ", " + rs.getString("FirstName"));
           }
           rs.close();
        }
        System.out.println();
        results = stmt.getMoreResults();
        } while(results);
      stmt.close();
      }
   catch (Exception e) {
      e.printStackTrace();
   }
}
</pre></span>
	</div>
    <p>Dans ce cas, le nombre de jeux de résultats retourné est deux. Cependant, le code est écrit de telle façon que si un nombre inconnu de jeux de résultats est retourné, comme lors de l'appel d'une procédure stockée, tous les jeux de résultats sont traités. Pour découvrir un exemple d'appel de procédure stockée qui retourne plusieurs jeux de résultats avec des valeurs de mise à jour, voir <a href="6b807a45-a8b5-4b1c-8b7b-d8175c710ce0.htm">Gestion d'instructions complexes</a>.</p>
    <div style="margin: .5em 1.5em .5em 1.5em"><b>Remarque : </b>
      Lors de l'appel de la méthode <b>getMoreResults</b> de la classe <b>SQLServerStatement</b>, le jeu de résultats précédemment retourné est implicitement fermé.<p></p>
    </div>
  </div>
      <span id="seeAlsoSpan">
        <h1 class="heading">
          Voir aussi
        </h1>
        <div id="seeAlsoSection" class="section">
          <a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Utilisation d'instructions avec le pilote JDBC</a>
        </div>
      </span>
      <!--[if gte IE 5]>
			<tool:tip element="seeAlsoToolTip" avoidmouse="false"/><tool:tip element="languageFilterToolTip" avoidmouse="false"/>
		<![endif]-->
      <div id="footer" class="section">
        <hr /><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span>
		<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">
			
			© 2006 Microsoft Corporation. Tous droits réservés.
		</a>
 	
      </div>
    </div>
  </body>
</html>